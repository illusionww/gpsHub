var layout;var map;var driver={};$(document).ready(function(){initMap();setInterval(getDrivers,1500)});window.onresize=function(a){mapResize()};function initMap(){var a={projection:new OpenLayers.Projection("EPSG:900913"),displayProjection:new OpenLayers.Projection("EPSG:4326"),layers:[new OpenLayers.Layer.OSM()],controls:[new OpenLayers.Control.Navigation({dragPanOptions:{enableKinetic:true}}),new OpenLayers.Control.Attribution(),new OpenLayers.Control.Zoom({zoomInId:"zoom-in",zoomOutId:"zoom-out"}),new OpenLayers.Control.ScaleLine(),new OpenLayers.Control.MousePosition()]};map=new OpenLayers.Map("map-canvas",a);map.setCenter(coord(37.61778,55.75167),11);markers=new OpenLayers.Layer.Markers("Markers");map.addLayer(markers);initLayout();$("#list-layout").show();mapResize()}function initLayout(){layout=$("#container").layout({closeable:false,slidable:false,center__paneSelector:"#map-layout",west__paneSelector:"#list-layout",center__minWidth:300,west__size:250,west__minSize:200,spacing_open:1,spacing_closed:10,livePaneResizing:true,stateManagement__enabled:true,onresize:function(){mapResize()}})}function mapResize(){var a=map.getCenter();map.updateSize();map.setCenter(a)}function getDrivers(){$.ajax({url:"actions/Drivers.php",type:"GET",data:"yes",dataType:"json",success:function(b){var a=Object.keys(b);a.forEach(function(c){driver[c]=addPoint(b[c].lat,b[c].lng)})}})}function addPoint(e,b){var c=new OpenLayers.Size(21,25);var f=new OpenLayers.Pixel(-(c.w/2),-c.h);var d=new OpenLayers.Icon("http://www.openlayers.org/dev/img/marker.png",c,f);var a=new OpenLayers.Marker(coord(e,b),d.clone());markers.addMarker(a);return a}function movePoint(c,b,a){a.moveTo(coord(c,b))}$(document).on("input",".clearable",function(){$(this)[tog(this.value)]("x")}).on("mousemove",".x",function(a){$(this)[tog(this.offsetWidth-18<a.clientX-this.getBoundingClientRect().left)]("onX")}).on("click",".onX",function(){$(this).removeClass("x onX").val("")});function tog(a){return a?"addClass":"removeClass"}function coord(c,b){var a=new OpenLayers.Geometry.Point(c,b);a.transform(new OpenLayers.Projection("EPSG:4326"),new OpenLayers.Projection("EPSG:900913"));return new OpenLayers.LonLat(a.x,a.y)};